[{"path":"/CONTRIBUTING.html","id":null,"dir":"","previous_headings":"","what":"Contributing to ggtranscript","title":"Contributing to ggtranscript","text":"outlines propose change ggtranscript. detailed info contributing , tidyverse packages, please see development contributing guide.","code":""},{"path":"/CONTRIBUTING.html","id":"fixing-typos","dir":"","previous_headings":"","what":"Fixing typos","title":"Contributing to ggtranscript","text":"can fix typos, spelling mistakes, grammatical errors documentation directly using GitHub web interface, long changes made source file. generally means ’ll need edit roxygen2 comments .R, .Rd file. can find .R file generates .Rd reading comment first line.","code":""},{"path":"/CONTRIBUTING.html","id":"bigger-changes","dir":"","previous_headings":"","what":"Bigger changes","title":"Contributing to ggtranscript","text":"want make bigger change, ’s good idea first file issue make sure someone team agrees ’s needed. ’ve found bug, please file issue illustrates bug minimal reprex (also help write unit test, needed).","code":""},{"path":"/CONTRIBUTING.html","id":"pull-request-process","dir":"","previous_headings":"Bigger changes","what":"Pull request process","title":"Contributing to ggtranscript","text":"Fork package clone onto computer. haven’t done , recommend using usethis::create_from_github(\"dzhang32/ggtranscript\", fork = TRUE). Install development dependencies devtools::install_dev_deps(), make sure package passes R CMD check running devtools::check(). R CMD check doesn’t pass cleanly, ’s good idea ask help continuing. Create Git branch pull request (PR). recommend using usethis::pr_init(\"brief-description--change\"). Make changes, commit git, create PR running usethis::pr_push(), following prompts browser. title PR briefly describe change. body PR contain Fixes #issue-number. user-facing changes, add bullet top NEWS.md (.e. just first header). Follow style described https://style.tidyverse.org/news.html.","code":""},{"path":"/CONTRIBUTING.html","id":"code-style","dir":"","previous_headings":"Bigger changes","what":"Code style","title":"Contributing to ggtranscript","text":"New code follow tidyverse style guide. can use styler package apply styles, please don’t restyle code nothing PR. use roxygen2, Markdown syntax, documentation. use testthat unit tests. Contributions test cases included easier accept.","code":""},{"path":"/CONTRIBUTING.html","id":"code-of-conduct","dir":"","previous_headings":"","what":"Code of Conduct","title":"Contributing to ggtranscript","text":"Please note ggtranscript project released Contributor Code Conduct. contributing project agree abide terms.","code":""},{"path":"/articles/ggtranscript.html","id":"basics","dir":"Articles","previous_headings":"","what":"Basics","title":"Introduction to ggtranscript","text":"completed…","code":""},{"path":"/articles/ggtranscript.html","id":"install-ggtranscript","dir":"Articles","previous_headings":"Basics","what":"Install ggtranscript","title":"Introduction to ggtranscript","text":"R open-source statistical environment can easily modified enhance functionality via packages. ggtranscript R package available via Bioconductor repository packages. R can installed operating system CRAN can install ggtranscript using following commands R session:","code":"if (!requireNamespace(\"BiocManager\", quietly = TRUE)) {     install.packages(\"BiocManager\") }  BiocManager::install(\"ggtranscript\")  ## Check that you have a valid Bioconductor installation BiocManager::valid()"},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"David Zhang. Author, maintainer. Emil Gustavsson. Author.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Zhang D, Gustavsson E (2022). ggtranscript: Visualising transcript structure annotation using ggplot2. R package version 0.99.1, https://github.com/dzhang32/ggtranscript.","code":"@Manual{,   title = {ggtranscript: Visualising transcript structure and annotation using ggplot2},   author = {David Zhang and Emil Gustavsson},   year = {2022},   note = {R package version 0.99.1},   url = {https://github.com/dzhang32/ggtranscript}, }"},{"path":[]},{"path":"/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"Visualising transcript structure and annotation using ggplot2","text":"ggtranscript ggplot2 extension makes easy visualize transcript structure annotation.","code":""},{"path":"/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Visualising transcript structure and annotation using ggplot2","text":"","code":"# you can install the development version of ggtranscript from GitHub: # install.packages(\"devtools\") devtools::install_github(\"dzhang32/ggtranscript\")"},{"path":"/index.html","id":"usage","dir":"","previous_headings":"","what":"Usage","title":"Visualising transcript structure and annotation using ggplot2","text":"ggtranscript introduces 5 new geoms (geom_range(), geom_half_range(), geom_intron(), geom_junction() geom_junction_label_repel()) several helper functions designed visualize transcript structure annotation. geom_range() geom_intron() enable plotting exons introns, core components transcript annotation. ggtranscript also provides to_intron(), convert exon co-ordinates corresponding introns. Together, ggtranscript enables users plot transcript structures exons required input lines code.  geom_range() designed used range-based genomic annotation. example, plotting protein-coding transcripts, can used visually distinguish coding segments UTRs.  geom_half_range() takes advantage vertical symmetry transcript annotation plotting half range top bottom transcript structure. can useful visualizing differences transcript structure.  ggplot2 extension, ggtranscript geoms inherit functionality ggplot2. instance, leveraging coord_cartesian(), can useful zoom areas interest.  geom_junction() enables plotting junction curves, can useful overlay across transcript structures. geom_junction_repel() labels junction curves, example counts.  Alternatively, users may prefer map count thickness junction line. ggplot2 extension, can done intuitively well modification scales themes together, allow users easily create informative, publication-ready plots.","code":"library(magrittr) library(dplyr) #>  #> Attaching package: 'dplyr' #> The following objects are masked from 'package:stats': #>  #>     filter, lag #> The following objects are masked from 'package:base': #>  #>     intersect, setdiff, setequal, union library(ggplot2) library(ggtranscript)  # to illustrate the package's functionality # ggtranscript includes example transcript annotation sod1_annotation %>% head() #> # A tibble: 6 × 8 #>   seqnames  start    end strand type  gene_name transcript_name transcript_biot… #>   <fct>     <int>  <int> <fct>  <fct> <chr>     <chr>           <chr>            #> 1 21       3.17e7 3.17e7 +      gene  SOD1      <NA>            <NA>             #> 2 21       3.17e7 3.17e7 +      tran… SOD1      SOD1-202        protein_coding   #> 3 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-202        protein_coding   #> 4 21       3.17e7 3.17e7 +      CDS   SOD1      SOD1-202        protein_coding   #> 5 21       3.17e7 3.17e7 +      star… SOD1      SOD1-202        protein_coding   #> 6 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-202        protein_coding  # extract exons sod1_exons <- sod1_annotation %>% dplyr::filter(type == \"exon\")  sod1_exons %>%     ggplot(aes(         xstart = start,         xend = end,         y = transcript_name     )) +     geom_range(         aes(fill = transcript_biotype)     ) +     geom_intron(         data = to_intron(sod1_exons, \"transcript_name\"),         aes(strand = strand),         arrow.min.intron.length = 500,     ) # filter for exons from protein coding transcripts sod1_exons_prot_cod <- sod1_exons %>%     dplyr::filter(transcript_biotype == \"protein_coding\")  # obtain cds sod1_cds <- sod1_annotation %>% dplyr::filter(type == \"CDS\")  sod1_exons_prot_cod %>%     ggplot(aes(         xstart = start,         xend = end,         y = transcript_name     )) +     geom_range(         fill = \"white\",         height = 0.25     ) +     geom_range(         data = sod1_cds     ) +     geom_intron(         data = to_intron(sod1_exons_prot_cod, \"transcript_name\"),         aes(strand = strand),         arrow.min.intron.length = 500,     ) # geom_half_range() can be useful for comparing between two transcripts # enabling visualization of one transcript on the top, other on the bottom sod1_201_exons <- sod1_exons %>% dplyr::filter(transcript_name == \"SOD1-201\") sod1_201_cds <- sod1_cds %>% dplyr::filter(transcript_name == \"SOD1-201\") sod1_202_exons <- sod1_exons %>% dplyr::filter(transcript_name == \"SOD1-202\") sod1_202_cds <- sod1_cds %>% dplyr::filter(transcript_name == \"SOD1-202\")  sod1_201_202_plot <- sod1_201_exons %>%     ggplot(aes(         xstart = start,         xend = end,         y = \"SOD1-201/202\"     )) +     geom_half_range(         fill = \"white\",         height = 0.125     ) +     geom_half_range(         data = sod1_201_cds     ) +     geom_intron(         data = to_intron(sod1_201_exons, \"transcript_name\")     ) +     geom_half_range(         data = sod1_202_exons,         range.orientation = \"top\",         fill = \"white\",         height = 0.125     ) +     geom_half_range(         data = sod1_202_cds,         range.orientation = \"top\",         fill = \"purple\"     ) +     geom_intron(         data = to_intron(sod1_202_exons, \"transcript_name\")     )  sod1_201_202_plot sod1_201_202_plot + coord_cartesian(xlim = c(31659500, 31660000)) # ggtranscript includes a set of example (unannotated) junctions # originating from GTEx and downloaded via the Bioconductor package snapcount sod1_junctions #> # A tibble: 5 × 5 #>   seqnames    start      end strand mean_count #>   <fct>       <int>    <int> <fct>       <dbl> #> 1 chr21    31659787 31666448 +           0.463 #> 2 chr21    31659842 31660554 +           0.831 #> 3 chr21    31659842 31663794 +           0.316 #> 4 chr21    31659842 31667257 +           4.35  #> 5 chr21    31660351 31663789 +           0.324  # add transcript_name to junctions for plotting sod1_junctions <- sod1_junctions %>%     dplyr::mutate(transcript_name = \"SOD1-201\")  sod1_201_exons %>%   ggplot(aes(     xstart = start,     xend = end,     y = transcript_name   )) +   geom_range(     fill = \"white\",      height = 0.25   ) +   geom_range(     data = sod1_201_cds   ) +    geom_intron(     data = to_intron(sod1_201_exons, \"transcript_name\")   ) +    geom_junction(     data = sod1_junctions,     junction.y.max = 0.5   ) +   geom_junction_label_repel(     data = sod1_junctions,     aes(label = round(mean_count, 2)),     junction.y.max = 0.5   ) sod1_201_exons %>%   ggplot(aes(     xstart = start,     xend = end,     y = transcript_name   )) +   geom_range(     fill = \"white\",      height = 0.25   ) +   geom_range(     data = sod1_201_cds   ) +    geom_intron(     data = to_intron(sod1_201_exons, \"transcript_name\")   ) +    geom_junction(     data = sod1_junctions,     aes(size = mean_count),     junction.y.max = 0.5,      ncp = 30,      colour = \"purple\"   ) +    scale_size_continuous(range = c(0.1, 1), guide = \"none\") +    xlab(\"Genomic position (chr21)\") +    ylab(\"Transcript name\") +    theme_bw()"},{"path":"/index.html","id":"code-of-conduct","dir":"","previous_headings":"","what":"Code of Conduct","title":"Visualising transcript structure and annotation using ggplot2","text":"Please note ggtranscript package released Contributor Code Conduct. contributing project, agree abide terms.","code":""},{"path":"/index.html","id":"development-tools","dir":"","previous_headings":"","what":"Development tools","title":"Visualising transcript structure and annotation using ggplot2","text":"Continuous code testing possible thanks GitHub actions usethis, remotes, rcmdcheck customized use Bioconductor’s docker containers BiocCheck. Code coverage assessment possible thanks codecov covr. documentation website automatically updated thanks pkgdown. code styled automatically thanks styler. documentation formatted thanks devtools roxygen2. package developed using biocthis.","code":""},{"path":"/reference/add_exon_number.html","id":null,"dir":"Reference","previous_headings":"","what":"Add exon number — add_exon_number","title":"Add exon number — add_exon_number","text":"add_exon_number() adds exon number (order exons transcribed within transcript) column exons. can useful visualizing long, complex transcript structures, order keep track specific exons interest.","code":""},{"path":"/reference/add_exon_number.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add exon number — add_exon_number","text":"","code":"add_exon_number(exons, group_var = NULL)"},{"path":"/reference/add_exon_number.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add exon number — add_exon_number","text":"exons data.frame() contains exons can originate multiple transcripts differentiated group_var. group_var character() input data originates 1 transcript, group_var must specify column differentiates transcripts (e.g. \"transcript_id\").","code":""},{"path":"/reference/add_exon_number.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add exon number — add_exon_number","text":"data.frame() equivalent input exons, additional column \"exon_number\".","code":""},{"path":"/reference/add_exon_number.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Add exon number — add_exon_number","text":"note, \"strand\" column must present within exons. strand used differentiate whether exon numbers calculated according ascending (\"+\") descending (\"-\") genomic co-ordinates. ambiguous strands (\"*\"), add_exon_number() assumed strand \"+\".","code":""},{"path":"/reference/add_exon_number.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add exon number — add_exon_number","text":"","code":"library(magrittr) library(ggplot2)  # to illustrate the package's functionality # ggtranscript includes example transcript annotation sod1_annotation %>% head() #> # A tibble: 6 × 8 #>   seqnames  start    end strand type  gene_name transcript_name transcript_biot… #>   <fct>     <int>  <int> <fct>  <fct> <chr>     <chr>           <chr>            #> 1 21       3.17e7 3.17e7 +      gene  SOD1      NA              NA               #> 2 21       3.17e7 3.17e7 +      tran… SOD1      SOD1-202        protein_coding   #> 3 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-202        protein_coding   #> 4 21       3.17e7 3.17e7 +      CDS   SOD1      SOD1-202        protein_coding   #> 5 21       3.17e7 3.17e7 +      star… SOD1      SOD1-202        protein_coding   #> 6 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-202        protein_coding    # extract exons sod1_exons <- sod1_annotation %>% dplyr::filter(type == \"exon\") sod1_exons %>% head() #> # A tibble: 6 × 8 #>   seqnames  start    end strand type  gene_name transcript_name transcript_biot… #>   <fct>     <int>  <int> <fct>  <fct> <chr>     <chr>           <chr>            #> 1 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-202        protein_coding   #> 2 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-202        protein_coding   #> 3 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-202        protein_coding   #> 4 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-202        protein_coding   #> 5 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-202        protein_coding   #> 6 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-204        processed_trans…  # add the exon number for each transcript sod1_exons <- sod1_exons %>% add_exon_number(group_var = \"transcript_name\")  base <- sod1_exons %>%     ggplot(aes(         xstart = start,         xend = end,         y = transcript_name     )) +     geom_range() +     geom_intron(         data = to_intron(sod1_exons, \"transcript_name\"),         strand = \"+\"     )  # it can be useful to annotate exons with their exon number # using ggplot2::geom_text() base +     geom_text(aes(         x = (start + end) / 2, # plot label at midpoint of exon         label = exon_number     ),     size = 3.5,     nudge_y = 0.4     )   # Or alternatively, using ggrepel::geom_label_repel() # to separate labels from exons base +     ggrepel::geom_label_repel(ggplot2::aes(         x = (start + end) / 2,         label = exon_number     ),     size = 3.5,     min.segment.length = 0     )"},{"path":"/reference/geom_intron.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot intron lines with strand arrows — geom_intron","title":"Plot intron lines with strand arrows — geom_intron","text":"geom_intron() draws horizontal lines central arrows designed represent introns. combination geom_range()/geom_half_range(), geoms form core components visualizing transcript annotation.","code":""},{"path":"/reference/geom_intron.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot intron lines with strand arrows — geom_intron","text":"","code":"geom_intron(   mapping = NULL,   data = NULL,   stat = \"identity\",   position = \"identity\",   ...,   arrow = grid::arrow(ends = \"last\", length = grid::unit(0.1, \"inches\")),   arrow.fill = NULL,   lineend = \"butt\",   linejoin = \"round\",   na.rm = FALSE,   arrow.min.intron.length = 0,   show.legend = NA,   inherit.aes = TRUE )"},{"path":"/reference/geom_intron.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot intron lines with strand arrows — geom_intron","text":"mapping Set aesthetic mappings created aes() aes_(). specified inherit.aes = TRUE (default), combined default mapping top level plot. must supply mapping plot mapping. data data displayed layer. three options: NULL, default, data inherited plot data specified call ggplot(). data.frame, object, override plot data. objects fortified produce data frame. See fortify() variables created. function called single argument, plot data. return value must data.frame, used layer data. function can created formula (e.g. ~ head(.x, 10)). stat statistical transformation use data layer, string. position Position adjustment, either string, result call position adjustment function. ... arguments passed layer(). often aesthetics, used set aesthetic fixed value, like colour = \"red\" size = 3. may also parameters paired geom/stat. arrow specification arrow heads, created arrow(). arrow.fill fill colour use arrow head (closed). NULL means use colour aesthetic. lineend Line end style (round, butt, square). linejoin Line join style (round, mitre, bevel). na.rm FALSE, default, missing values removed warning. TRUE, missing values silently removed. arrow.min.intron.length integer() minimum required width intron strand arrow drawn. can useful remove strand arrows short introns overlap adjacent exons. show.legend logical. layer included legends? NA, default, includes aesthetics mapped. FALSE never includes, TRUE always includes. can also named logical vector finely select aesthetics display. inherit.aes FALSE, overrides default aesthetics, rather combining . useful helper functions define data aesthetics inherit behaviour default plot specification, e.g. borders().","code":""},{"path":"/reference/geom_intron.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot intron lines with strand arrows — geom_intron","text":"geom_intron() requires following aes(); xstart, xend y (e.g. transcript name). strand option (one \"+\" \"-\") adjusts arrow direction match direction transcription. arrow.min.intron.length parameter can useful remove strand arrows overlap exons, can problem plotted introns include relatively short.","code":""},{"path":"/reference/geom_intron.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot intron lines with strand arrows — geom_intron","text":"","code":"library(magrittr) library(ggplot2)  # to illustrate the package's functionality # ggtranscript includes example transcript annotation pknox1_annotation %>% head() #> # A tibble: 6 × 8 #>   seqnames  start    end strand type  gene_name transcript_name transcript_biot… #>   <fct>     <int>  <int> <fct>  <fct> <chr>     <chr>           <chr>            #> 1 21       4.30e7 4.30e7 +      gene  PKNOX1    NA              NA               #> 2 21       4.30e7 4.30e7 +      tran… PKNOX1    PKNOX1-203      protein_coding   #> 3 21       4.30e7 4.30e7 +      exon  PKNOX1    PKNOX1-203      protein_coding   #> 4 21       4.30e7 4.30e7 +      exon  PKNOX1    PKNOX1-203      protein_coding   #> 5 21       4.30e7 4.30e7 +      exon  PKNOX1    PKNOX1-203      protein_coding   #> 6 21       4.30e7 4.30e7 +      exon  PKNOX1    PKNOX1-203      protein_coding    # extract exons pknox1_exons <- pknox1_annotation %>% dplyr::filter(type == \"exon\") pknox1_exons %>% head() #> # A tibble: 6 × 8 #>   seqnames  start    end strand type  gene_name transcript_name transcript_biot… #>   <fct>     <int>  <int> <fct>  <fct> <chr>     <chr>           <chr>            #> 1 21       4.30e7 4.30e7 +      exon  PKNOX1    PKNOX1-203      protein_coding   #> 2 21       4.30e7 4.30e7 +      exon  PKNOX1    PKNOX1-203      protein_coding   #> 3 21       4.30e7 4.30e7 +      exon  PKNOX1    PKNOX1-203      protein_coding   #> 4 21       4.30e7 4.30e7 +      exon  PKNOX1    PKNOX1-203      protein_coding   #> 5 21       4.30e7 4.30e7 +      exon  PKNOX1    PKNOX1-203      protein_coding   #> 6 21       4.30e7 4.30e7 +      exon  PKNOX1    PKNOX1-203      protein_coding    # to_intron() is a helper function included in ggtranscript # which is useful for converting exon co-ordinates to introns pknox1_introns <- pknox1_exons %>% to_intron(group_var = \"transcript_name\") pknox1_introns %>% head() #> # A tibble: 6 × 8 #>   seqnames strand type  gene_name transcript_name transcript_biot…  start    end #>   <fct>    <fct>  <chr> <chr>     <chr>           <chr>             <int>  <int> #> 1 21       +      intr… PKNOX1    PKNOX1-203      protein_coding   4.30e7 4.30e7 #> 2 21       +      intr… PKNOX1    PKNOX1-202      retained_intron  4.30e7 4.30e7 #> 3 21       +      intr… PKNOX1    PKNOX1-201      protein_coding   4.30e7 4.30e7 #> 4 21       +      intr… PKNOX1    PKNOX1-206      retained_intron  4.30e7 4.30e7 #> 5 21       +      intr… PKNOX1    PKNOX1-204      retained_intron  4.30e7 4.30e7 #> 6 21       +      intr… PKNOX1    PKNOX1-203      protein_coding   4.30e7 4.30e7  base <- pknox1_introns %>%     ggplot(aes(         xstart = start,         xend = end,         y = transcript_name     ))  # by default, geom_intron() assumes introns originate from the \"+\" strand base + geom_intron()   # however this can be modified using the strand option base + geom_intron(strand = \"-\")   # strand can also be set as an aes() base + geom_intron(aes(strand = strand))   # as a ggplot2 extension, ggtranscript geoms inherit the # the functionality from the parameters and aesthetics in ggplot2 base + geom_intron(     aes(colour = transcript_name),     size = 1 )   # together, geom_range() and geom_intron() are designed to visualize # the core components of transcript annotation pknox1_exons %>%     ggplot(aes(         xstart = start,         xend = end,         y = transcript_name     )) +     geom_range() +     geom_intron(         data = pknox1_introns     )   # for short introns, sometimes strand arrows will overlap exons # to avoid this, users can set the arrow.min.intron.length parameter pknox1_exons %>%     ggplot(aes(         xstart = start,         xend = end,         y = transcript_name     )) +     geom_range() +     geom_intron(         data = pknox1_introns,         arrow.min.intron.length = 3500     )"},{"path":"/reference/geom_junction.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot junction curves — geom_junction","title":"Plot junction curves — geom_junction","text":"geom_junction() draws curves designed represent junction reads RNA-sequencing data. can useful overlay junction data transcript annotation (plotted using geom_range()/geom_half_range() geom_intron()) understand splicing events transcripts support RNA-sequencing data.","code":""},{"path":"/reference/geom_junction.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot junction curves — geom_junction","text":"","code":"geom_junction(   mapping = NULL,   data = NULL,   stat = \"identity\",   position = \"identity\",   junction.orientation = \"alternating\",   junction.y.max = 1,   angle = 90,   ncp = 15,   na.rm = FALSE,   orientation = NA,   show.legend = NA,   inherit.aes = TRUE,   ... )"},{"path":"/reference/geom_junction.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot junction curves — geom_junction","text":"mapping Set aesthetic mappings created aes() aes_(). specified inherit.aes = TRUE (default), combined default mapping top level plot. must supply mapping plot mapping. data data displayed layer. three options: NULL, default, data inherited plot data specified call ggplot(). data.frame, object, override plot data. objects fortified produce data frame. See fortify() variables created. function called single argument, plot data. return value must data.frame, used layer data. function can created formula (e.g. ~ head(.x, 10)). stat statistical transformation use data layer, string. position Position adjustment, either string, result call position adjustment function. junction.orientation character() one \"alternating\", \"top\" \"bottom\", specifying junctions plotted respect transcript (y). junction.y.max double() max y-value junction curve. can useful adjust parameter junction curves overlap one another/transcripts extend beyond plot margins. angle numeric value 0 180,     giving amount skew control     points curve.  Values less 90 skew curve towards     start point values greater 90 skew curve     towards end point. ncp number control points used draw curve.     control points creates smoother curve. na.rm FALSE, default, missing values removed warning. TRUE, missing values silently removed. orientation orientation layer. default (NA) automatically determines orientation aesthetic mapping. rare event fails can given explicitly setting orientation either \"x\" \"y\". See Orientation section detail. show.legend logical. layer included legends? NA, default, includes aesthetics mapped. FALSE never includes, TRUE always includes. can also named logical vector finely select aesthetics display. inherit.aes FALSE, overrides default aesthetics, rather combining . useful helper functions define data aesthetics inherit behaviour default plot specification, e.g. borders(). ... arguments passed layer(). often aesthetics, used set aesthetic fixed value, like colour = \"red\" size = 3. may also parameters paired geom/stat.","code":""},{"path":"/reference/geom_junction.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot junction curves — geom_junction","text":"geom_junction() requires following aes(); xstart, xend y (e.g. transcript name). geom_junction() curves can modified using junction.y.max, can useful junctions overlap one another/transcripts extend beyond plot margins. default, junction curves alternate plotted top bottom transcript (y), however can modified via junction.orientation.","code":""},{"path":"/reference/geom_junction.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot junction curves — geom_junction","text":"","code":"library(magrittr) library(ggplot2)  # to illustrate the package's functionality # ggtranscript includes example transcript annotation sod1_annotation %>% head() #> # A tibble: 6 × 8 #>   seqnames  start    end strand type  gene_name transcript_name transcript_biot… #>   <fct>     <int>  <int> <fct>  <fct> <chr>     <chr>           <chr>            #> 1 21       3.17e7 3.17e7 +      gene  SOD1      NA              NA               #> 2 21       3.17e7 3.17e7 +      tran… SOD1      SOD1-202        protein_coding   #> 3 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-202        protein_coding   #> 4 21       3.17e7 3.17e7 +      CDS   SOD1      SOD1-202        protein_coding   #> 5 21       3.17e7 3.17e7 +      star… SOD1      SOD1-202        protein_coding   #> 6 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-202        protein_coding    # as well as a set of example (unannotated) junctions # originating from GTEx and downloaded via the Bioconductor package snapcount sod1_junctions #> # A tibble: 5 × 5 #>   seqnames    start      end strand mean_count #>   <fct>       <int>    <int> <fct>       <dbl> #> 1 chr21    31659787 31666448 +           0.463 #> 2 chr21    31659842 31660554 +           0.831 #> 3 chr21    31659842 31663794 +           0.316 #> 4 chr21    31659842 31667257 +           4.35  #> 5 chr21    31660351 31663789 +           0.324  # extract exons sod1_exons <- sod1_annotation %>% dplyr::filter(     type == \"exon\",     transcript_name == \"SOD1-201\" ) sod1_exons %>% head() #> # A tibble: 5 × 8 #>   seqnames  start    end strand type  gene_name transcript_name transcript_biot… #>   <fct>     <int>  <int> <fct>  <fct> <chr>     <chr>           <chr>            #> 1 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-201        protein_coding   #> 2 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-201        protein_coding   #> 3 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-201        protein_coding   #> 4 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-201        protein_coding   #> 5 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-201        protein_coding    # add transcript_name to junctions for plotting sod1_junctions <- sod1_junctions %>%     dplyr::mutate(transcript_name = \"SOD1-201\")  # junctions can be plotted as curves using geom_junction() base <- sod1_junctions %>%     ggplot2::ggplot(ggplot2::aes(         xstart = start,         xend = end,         y = transcript_name     ))  # sometimes, depending on the number and widths of transcripts and junctions # junctions will go overlap one another or extend beyond the plot margin base + geom_junction()   # in such cases, junction.y.max can be adjusted to modify the max y of curves base + geom_junction(junction.y.max = 0.5)   # ncp can be used improve the smoothness of curves base + geom_junction(junction.y.max = 0.5, ncp = 30)   # junction.orientation controls where the junction are plotted # with respect to each transcript # either alternating (default), or on the top or bottom base + geom_junction(junction.orientation = \"top\", junction.y.max = 0.5)  base + geom_junction(junction.orientation = \"bottom\", junction.y.max = 0.5)   # it can be useful useful to overlay junction curves onto existing annotation # plotted using geom_range() and geom_intron() base <- sod1_exons %>%     ggplot(aes(         xstart = start,         xend = end,         y = transcript_name     )) +     geom_range() +     geom_intron(         data = to_intron(sod1_exons, \"transcript_name\")     )  base + geom_junction(     data = sod1_junctions,     junction.y.max = 0.5 )   # as a ggplot2 extension, ggtranscript geoms inherit the # the functionality from the parameters and aesthetics in ggplot2 # this can be useful when mapping junction thickness to their counts base + geom_junction(     data = sod1_junctions,     aes(size = mean_count),     junction.y.max = 0.5,     colour = \"purple\" ) +     scale_size(range = c(0.1, 1))   # it can be useful to combine geom_junction() with geom_half_range() sod1_exons %>%     ggplot(aes(         xstart = start,         xend = end,         y = transcript_name     )) +     geom_half_range() +     geom_intron(         data = to_intron(sod1_exons, \"transcript_name\")     ) +     geom_junction(         data = sod1_junctions,         aes(size = mean_count),         junction.y.max = 0.5,         junction.orientation = \"top\",         colour = \"purple\"     ) +     scale_size(range = c(0.1, 1))"},{"path":"/reference/geom_junction_label_repel.html","id":null,"dir":"Reference","previous_headings":"","what":"Label junction curves — geom_junction_label_repel","title":"Label junction curves — geom_junction_label_repel","text":"geom_junction_label_repel() labels junction curves midpoint using ggrepel::geom_label_repel(). can useful label compare junctions (plotted using geom_junction()) metrics usage (e.g. count percent-spliced-).","code":""},{"path":"/reference/geom_junction_label_repel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Label junction curves — geom_junction_label_repel","text":"","code":"geom_junction_label_repel(   mapping = NULL,   data = NULL,   stat = \"identity\",   position = \"identity\",   parse = FALSE,   ...,   junction.orientation = \"alternating\",   junction.y.max = 1,   angle = 90,   ncp = 15,   box.padding = 0.25,   label.padding = 0.25,   point.padding = 1e-06,   label.r = 0.15,   label.size = 0.25,   min.segment.length = 0,   arrow = NULL,   force = 1,   force_pull = 1,   max.time = 0.5,   max.iter = 10000,   max.overlaps = getOption(\"ggrepel.max.overlaps\", default = 10),   nudge_x = 0,   nudge_y = 0,   xlim = c(NA, NA),   ylim = c(NA, NA),   na.rm = FALSE,   show.legend = NA,   direction = c(\"both\", \"y\", \"x\"),   seed = NA,   verbose = FALSE,   inherit.aes = TRUE )"},{"path":"/reference/geom_junction_label_repel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Label junction curves — geom_junction_label_repel","text":"mapping Set aesthetic mappings created aes aes_. specified inherit.aes = TRUE (default), combined default mapping top level plot. need supply mapping mapping defined plot. data data frame. specified, overrides default data frame defined top level plot. stat statistical transformation use data layer, string. position Position adjustment, either string, result call position adjustment function. parse TRUE, labels parsed expressions displayed described ?plotmath ... arguments passed layer.   three types arguments can use :  Aesthetics: set aesthetic fixed value, like        colour = \"red\" size = 3. arguments layer, example override       default stat associated layer. arguments passed stat. junction.orientation character() one \"alternating\", \"top\" \"bottom\", specifying junctions plotted respect transcript (y). junction.y.max double() max y-value junction curve. can useful adjust parameter junction curves overlap one another/transcripts extend beyond plot margins. angle numeric value 0 180,     giving amount skew control     points curve.  Values less 90 skew curve towards     start point values greater 90 skew curve     towards end point. ncp number control points used draw curve.     control points creates smoother curve. box.padding Amount padding around bounding box, unit number. Defaults 0.25. (Default unit lines, units can specified passing unit(x, \"units\")). label.padding Amount padding around label, unit number. Defaults 0.25. (Default unit lines, units can specified passing unit(x, \"units\")). point.padding Amount padding around labeled point, unit number. Defaults 0. (Default unit lines, units can specified passing unit(x, \"units\")). label.r Radius rounded corners, unit number. Defaults 0.15. (Default unit lines, units can specified passing unit(x, \"units\")). label.size Size label border, mm. min.segment.length Skip drawing segments shorter , unit number. Defaults 0.5. (Default unit lines, units can specified passing unit(x, \"units\")). arrow specification arrow heads, created arrow force Force repulsion overlapping text labels. Defaults 1. force_pull Force attraction text label corresponding data point. Defaults 1. max.time Maximum number seconds try resolve overlaps. Defaults 0.5. max.iter Maximum number iterations try resolve overlaps. Defaults 10000. max.overlaps Exclude text labels overlap many things. Defaults 10. nudge_x Horizontal vertical adjustments nudge starting position text label. units nudge_x nudge_y data units x-axis y-axis. nudge_y Horizontal vertical adjustments nudge starting position text label. units nudge_x nudge_y data units x-axis y-axis. xlim Limits x y axes. Text labels constrained limits. default, text labels constrained entire plot area. ylim Limits x y axes. Text labels constrained limits. default, text labels constrained entire plot area. na.rm FALSE (default), removes missing values warning.  TRUE silently removes missing values. show.legend logical. layer included legends? NA, default, includes aesthetics mapped. FALSE never includes, TRUE always includes. direction \"\", \"x\", \"y\" -- direction adjust position labels seed Random seed passed set.seed. Defaults NA, means set.seed called. verbose TRUE, diagnostics repel algorithm printed inherit.aes FALSE, overrides default aesthetics, rather combining . useful helper functions define data aesthetics inherit behaviour default plot specification, e.g. borders.","code":""},{"path":"/reference/geom_junction_label_repel.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Label junction curves — geom_junction_label_repel","text":"geom_junction_label_repel() requires following aes(); xstart, xend, y (e.g. transcript name) label. hood, geom_junction_label_repel() generates junction curves geom_junction() obtain curve midpoints labeling. Therefore, important users use input data parameters alter junction curves (namely junction.orientation, junction.y.max, angle, ncp) geom_junction_label_repel() used geom_junction().","code":""},{"path":"/reference/geom_junction_label_repel.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Label junction curves — geom_junction_label_repel","text":"","code":"library(magrittr) library(ggplot2)  # to illustrate the package's functionality # ggtranscript includes example transcript annotation sod1_annotation %>% head() #> # A tibble: 6 × 8 #>   seqnames  start    end strand type  gene_name transcript_name transcript_biot… #>   <fct>     <int>  <int> <fct>  <fct> <chr>     <chr>           <chr>            #> 1 21       3.17e7 3.17e7 +      gene  SOD1      NA              NA               #> 2 21       3.17e7 3.17e7 +      tran… SOD1      SOD1-202        protein_coding   #> 3 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-202        protein_coding   #> 4 21       3.17e7 3.17e7 +      CDS   SOD1      SOD1-202        protein_coding   #> 5 21       3.17e7 3.17e7 +      star… SOD1      SOD1-202        protein_coding   #> 6 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-202        protein_coding    # as well as a set of example (unannotated) junctions # originating from GTEx and downloaded via the Bioconductor package snapcount sod1_junctions #> # A tibble: 5 × 5 #>   seqnames    start      end strand mean_count #>   <fct>       <int>    <int> <fct>       <dbl> #> 1 chr21    31659787 31666448 +           0.463 #> 2 chr21    31659842 31660554 +           0.831 #> 3 chr21    31659842 31663794 +           0.316 #> 4 chr21    31659842 31667257 +           4.35  #> 5 chr21    31660351 31663789 +           0.324  # extract exons sod1_exons <- sod1_annotation %>% dplyr::filter(     type == \"exon\",     transcript_name == \"SOD1-201\" ) sod1_exons %>% head() #> # A tibble: 5 × 8 #>   seqnames  start    end strand type  gene_name transcript_name transcript_biot… #>   <fct>     <int>  <int> <fct>  <fct> <chr>     <chr>           <chr>            #> 1 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-201        protein_coding   #> 2 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-201        protein_coding   #> 3 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-201        protein_coding   #> 4 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-201        protein_coding   #> 5 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-201        protein_coding    # add transcript_name to junctions for plotting sod1_junctions <- sod1_junctions %>%     dplyr::mutate(transcript_name = \"SOD1-201\")  # geom_junction_label_repel() can be used to label junctions base <- sod1_exons %>%     ggplot(aes(         xstart = start,         xend = end,         y = transcript_name     )) +     geom_range() +     geom_intron(         data = to_intron(sod1_exons, \"transcript_name\")     )  # this can be useful to label junctions with their counts base +     geom_junction(         data = sod1_junctions,         junction.y.max = 0.5     ) +     geom_junction_label_repel(         data = sod1_junctions,         aes(label = round(mean_count, 2)),         junction.y.max = 0.5     )"},{"path":"/reference/geom_range.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot genomic ranges — geom_range","title":"Plot genomic ranges — geom_range","text":"geom_range() geom_half_range() draw tiles designed represent range-based genomic features, exons. combination geom_intron(), geoms form core components visualizing transcript annotation.","code":""},{"path":"/reference/geom_range.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot genomic ranges — geom_range","text":"","code":"geom_range(   mapping = NULL,   data = NULL,   stat = \"identity\",   position = \"identity\",   ...,   vjust = NULL,   linejoin = \"mitre\",   na.rm = FALSE,   show.legend = NA,   inherit.aes = TRUE )  geom_half_range(   mapping = NULL,   data = NULL,   stat = \"identity\",   position = \"identity\",   ...,   range.orientation = \"bottom\",   linejoin = \"mitre\",   na.rm = FALSE,   show.legend = NA,   inherit.aes = TRUE )"},{"path":"/reference/geom_range.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot genomic ranges — geom_range","text":"mapping Set aesthetic mappings created aes() aes_(). specified inherit.aes = TRUE (default), combined default mapping top level plot. must supply mapping plot mapping. data data displayed layer. three options: NULL, default, data inherited plot data specified call ggplot(). data.frame, object, override plot data. objects fortified produce data frame. See fortify() variables created. function called single argument, plot data. return value must data.frame, used layer data. function can created formula (e.g. ~ head(.x, 10)). stat statistical transformation use data layer, string. position Position adjustment, either string, result call position adjustment function. ... arguments passed layer(). often aesthetics, used set aesthetic fixed value, like colour = \"red\" size = 3. may also parameters paired geom/stat. vjust horizontal vertical justification grob.  justification value number 0 1.  Defaults 0.5 , centering pixel data location. linejoin Line join style (round, mitre, bevel). na.rm FALSE, default, missing values removed warning. TRUE, missing values silently removed. show.legend logical. layer included legends? NA, default, includes aesthetics mapped. FALSE never includes, TRUE always includes. can also named logical vector finely select aesthetics display. inherit.aes FALSE, overrides default aesthetics, rather combining . useful helper functions define data aesthetics inherit behaviour default plot specification, e.g. borders(). range.orientation character() one \"top\" \"bottom\", specifying half ranges plotted respect transcript (y).","code":""},{"path":"/reference/geom_range.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot genomic ranges — geom_range","text":"geom_range() geom_half_range() require following aes(); xstart, xend y (e.g. transcript name). geom_half_range() takes advantage vertical symmetry transcript annotation plotting half range top bottom transcript structure. can useful free plotting space transcript annotations (e.g. geom_junction()).","code":""},{"path":"/reference/geom_range.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot genomic ranges — geom_range","text":"","code":"library(magrittr) library(ggplot2)  # to illustrate the package's functionality # ggtranscript includes example transcript annotation sod1_annotation %>% head() #> # A tibble: 6 × 8 #>   seqnames  start    end strand type  gene_name transcript_name transcript_biot… #>   <fct>     <int>  <int> <fct>  <fct> <chr>     <chr>           <chr>            #> 1 21       3.17e7 3.17e7 +      gene  SOD1      NA              NA               #> 2 21       3.17e7 3.17e7 +      tran… SOD1      SOD1-202        protein_coding   #> 3 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-202        protein_coding   #> 4 21       3.17e7 3.17e7 +      CDS   SOD1      SOD1-202        protein_coding   #> 5 21       3.17e7 3.17e7 +      star… SOD1      SOD1-202        protein_coding   #> 6 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-202        protein_coding    # extract exons sod1_exons <- sod1_annotation %>% dplyr::filter(type == \"exon\") sod1_exons %>% head() #> # A tibble: 6 × 8 #>   seqnames  start    end strand type  gene_name transcript_name transcript_biot… #>   <fct>     <int>  <int> <fct>  <fct> <chr>     <chr>           <chr>            #> 1 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-202        protein_coding   #> 2 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-202        protein_coding   #> 3 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-202        protein_coding   #> 4 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-202        protein_coding   #> 5 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-202        protein_coding   #> 6 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-204        processed_trans…  base <- sod1_exons %>%     ggplot(aes(         xstart = start,         xend = end,         y = transcript_name     ))  # geom_range() is designed to visualise range-based annotation such as exons base + geom_range()   # geom_half_range() allows users to plot half ranges # on the top or bottom of the transcript base + geom_half_range()   # where the half ranges are plotted can be adjusted using range.orientation base + geom_half_range(range.orientation = \"top\")   # as a ggplot2 extension, ggtranscript geoms inherit the # the functionality from the parameters and aesthetics in ggplot2 base + geom_range(     aes(fill = transcript_name),     size = 1 )   # together, geom_range() and geom_intron() are designed to visualize # the core components of transcript annotation base + geom_range(     aes(fill = transcript_biotype) ) +     geom_intron(         data = to_intron(sod1_exons, \"transcript_name\")     )   # for protein coding transcripts # geom_range() be useful for visualizing UTRs that lie outside of the CDS sod1_exons_prot_coding <- sod1_exons %>%     dplyr::filter(transcript_biotype == \"protein_coding\")  # extract cds sod1_cds <- sod1_annotation %>%     dplyr::filter(type == \"CDS\")  sod1_exons_prot_coding %>%     ggplot(aes(         xstart = start,         xend = end,         y = transcript_name     )) +     geom_range(         fill = \"white\",         height = 0.25     ) +     geom_range(         data = sod1_cds     ) +     geom_intron(         data = to_intron(sod1_exons_prot_coding, \"transcript_name\")     )   # geom_half_range() can be useful for comparing between two transcripts # enabling visualization of one transcript on the top, other on the bottom sod1_201_exons <- sod1_exons %>% dplyr::filter(transcript_name == \"SOD1-201\") sod1_201_cds <- sod1_cds %>% dplyr::filter(transcript_name == \"SOD1-201\") sod1_202_exons <- sod1_exons %>% dplyr::filter(transcript_name == \"SOD1-202\") sod1_202_cds <- sod1_cds %>% dplyr::filter(transcript_name == \"SOD1-202\")  sod1_201_plot <- sod1_201_exons %>%     ggplot(aes(         xstart = start,         xend = end,         y = \"SOD1-201/202\"     )) +     geom_half_range(         fill = \"white\",         height = 0.125     ) +     geom_half_range(         data = sod1_201_cds     ) +     geom_intron(         data = to_intron(sod1_201_exons, \"transcript_name\")     )  sod1_201_plot   sod1_201_202_plot <- sod1_201_plot +     geom_half_range(         data = sod1_202_exons,         range.orientation = \"top\",         fill = \"white\",         height = 0.125     ) +     geom_half_range(         data = sod1_202_cds,         range.orientation = \"top\",         fill = \"purple\"     ) +     geom_intron(         data = to_intron(sod1_202_exons, \"transcript_name\")     )  sod1_201_202_plot   # leveraging existing ggplot2 functionality via e.g. coord_cartesian() # can be useful to zoom in on areas of interest sod1_201_202_plot + coord_cartesian(xlim = c(31659500, 31660000))"},{"path":"/reference/ggtranscript.html","id":null,"dir":"Reference","previous_headings":"","what":"ggtranscript: Visualizing transcript structure and annotation using\nggplot2 — ggtranscript","title":"ggtranscript: Visualizing transcript structure and annotation using\nggplot2 — ggtranscript","text":"goal ggtranscript simplify process visualizing transcript structure annotation. achieve , ggtranscript introduces 5 new geoms (geom_range(), geom_half_range(), geom_intron(), geom_junction() geom_junction_label_repel()) well several helper functions. ggplot2 extension, ggtranscript inherits ggplot2's familiarity flexibility, enabling users intuitively adjust aesthetics, parameters, scales etc well complement ggtranscript geoms existing ggplot2 geoms create informative, publication-ready plots.","code":""},{"path":"/reference/shorten_gaps.html","id":null,"dir":"Reference","previous_headings":"","what":"Improve transcript structure visualization by shortening gaps — shorten_gaps","title":"Improve transcript structure visualization by shortening gaps — shorten_gaps","text":"given set exons introns, shorten_gaps() reduces width gaps (regions overlap exons) user-inputted target_gap_width. can useful visualizing transcripts long introns, hone regions interest (.e. exons) better compare transcript structures.","code":""},{"path":"/reference/shorten_gaps.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Improve transcript structure visualization by shortening gaps — shorten_gaps","text":"","code":"shorten_gaps(exons, introns, group_var = NULL, target_gap_width = 100L)"},{"path":"/reference/shorten_gaps.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Improve transcript structure visualization by shortening gaps — shorten_gaps","text":"exons data.frame() contains exons can originate multiple transcripts differentiated group_var. introns data.frame() intron co-ordinates corresponding input exons. can created applying to_intron() exons. introns originate multiple transcripts, must differentiated using group_var. user using to_intron(), must make sure intron start/ends defined precisely adjacent exon boundaries (rather exon end + 1 exon start - 1). group_var character() input data originates 1 transcript, group_var must specify column differentiates transcripts (e.g. \"transcript_id\"). target_gap_width integer() width base pairs shorten gaps .","code":""},{"path":"/reference/shorten_gaps.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Improve transcript structure visualization by shortening gaps — shorten_gaps","text":"data.frame() contains re-scaled co-ordinates introns exons input transcript shortened gaps.","code":""},{"path":"/reference/shorten_gaps.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Improve transcript structure visualization by shortening gaps — shorten_gaps","text":"shorten_gaps() reduces size gaps, re-scale exons introns preserve exon alignment. process reduce width input introns, never exons. Importantly, outputted re-scaled co-ordinates used visualization match original genomic coordinates.","code":""},{"path":"/reference/shorten_gaps.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Improve transcript structure visualization by shortening gaps — shorten_gaps","text":"","code":"library(magrittr) library(ggplot2)  # to illustrate the package's functionality # ggtranscript includes example transcript annotation pknox1_annotation %>% head() #> # A tibble: 6 × 8 #>   seqnames  start    end strand type  gene_name transcript_name transcript_biot… #>   <fct>     <int>  <int> <fct>  <fct> <chr>     <chr>           <chr>            #> 1 21       4.30e7 4.30e7 +      gene  PKNOX1    NA              NA               #> 2 21       4.30e7 4.30e7 +      tran… PKNOX1    PKNOX1-203      protein_coding   #> 3 21       4.30e7 4.30e7 +      exon  PKNOX1    PKNOX1-203      protein_coding   #> 4 21       4.30e7 4.30e7 +      exon  PKNOX1    PKNOX1-203      protein_coding   #> 5 21       4.30e7 4.30e7 +      exon  PKNOX1    PKNOX1-203      protein_coding   #> 6 21       4.30e7 4.30e7 +      exon  PKNOX1    PKNOX1-203      protein_coding    # extract exons pknox1_exons <- pknox1_annotation %>% dplyr::filter(type == \"exon\") pknox1_exons %>% head() #> # A tibble: 6 × 8 #>   seqnames  start    end strand type  gene_name transcript_name transcript_biot… #>   <fct>     <int>  <int> <fct>  <fct> <chr>     <chr>           <chr>            #> 1 21       4.30e7 4.30e7 +      exon  PKNOX1    PKNOX1-203      protein_coding   #> 2 21       4.30e7 4.30e7 +      exon  PKNOX1    PKNOX1-203      protein_coding   #> 3 21       4.30e7 4.30e7 +      exon  PKNOX1    PKNOX1-203      protein_coding   #> 4 21       4.30e7 4.30e7 +      exon  PKNOX1    PKNOX1-203      protein_coding   #> 5 21       4.30e7 4.30e7 +      exon  PKNOX1    PKNOX1-203      protein_coding   #> 6 21       4.30e7 4.30e7 +      exon  PKNOX1    PKNOX1-203      protein_coding    # to_intron() is a helper function included in ggtranscript # which is useful for converting exon co-ordinates to introns pknox1_introns <- pknox1_exons %>% to_intron(group_var = \"transcript_name\") pknox1_introns %>% head() #> # A tibble: 6 × 8 #>   seqnames strand type  gene_name transcript_name transcript_biot…  start    end #>   <fct>    <fct>  <chr> <chr>     <chr>           <chr>             <int>  <int> #> 1 21       +      intr… PKNOX1    PKNOX1-203      protein_coding   4.30e7 4.30e7 #> 2 21       +      intr… PKNOX1    PKNOX1-202      retained_intron  4.30e7 4.30e7 #> 3 21       +      intr… PKNOX1    PKNOX1-201      protein_coding   4.30e7 4.30e7 #> 4 21       +      intr… PKNOX1    PKNOX1-206      retained_intron  4.30e7 4.30e7 #> 5 21       +      intr… PKNOX1    PKNOX1-204      retained_intron  4.30e7 4.30e7 #> 6 21       +      intr… PKNOX1    PKNOX1-203      protein_coding   4.30e7 4.30e7  # for transcripts with long introns, the exons of interest # can be difficult to visualize clearly when using the default scale pknox1_exons %>%     ggplot(aes(         xstart = start,         xend = end,         y = transcript_name     )) +     geom_range() +     geom_intron(         data = pknox1_introns,         arrow.min.intron.length = 3500     )   # in such cases it can be useful to rescale the exons and introns # using shorten_gaps() which shortens regions that do not overlap an exon pknox1_rescaled <-     shorten_gaps(pknox1_exons, pknox1_introns, group_var = \"transcript_name\")  pknox1_rescaled %>% head() #> # A tibble: 6 × 8 #>   seqnames start   end strand type   gene_name transcript_name transcript_bioty… #>   <fct>    <dbl> <dbl> <fct>  <chr>  <chr>     <chr>           <chr>             #> 1 21          54   156 +      exon   PKNOX1    PKNOX1-201      protein_coding    #> 2 21         156   694 +      intron PKNOX1    PKNOX1-201      protein_coding    #> 3 21         694   800 +      exon   PKNOX1    PKNOX1-201      protein_coding    #> 4 21         800   901 +      intron PKNOX1    PKNOX1-201      protein_coding    #> 5 21         901  1028 +      exon   PKNOX1    PKNOX1-201      protein_coding    #> 6 21        1028  1223 +      intron PKNOX1    PKNOX1-201      protein_coding     # this allows us to visualize differences in exonic structure more clearly pknox1_rescaled %>%     dplyr::filter(type == \"exon\") %>%     ggplot(aes(         xstart = start,         xend = end,         y = transcript_name     )) +     geom_range() +     geom_intron(         data = pknox1_rescaled %>% dplyr::filter(type == \"intron\"),         arrow.min.intron.length = 300     )   # shorten_gaps() can be used in combination with to_diff() # to further highlight differences in exon structure # here, all other transcripts are compared to the MANE-select transcript pknox1_rescaled_diffs <- to_diff(     exons = pknox1_rescaled %>%         dplyr::filter(type == \"exon\", transcript_name != \"PKNOX1-201\"),     ref_exons = pknox1_rescaled %>%         dplyr::filter(type == \"exon\", transcript_name == \"PKNOX1-201\"),     group_var = \"transcript_name\" )  pknox1_rescaled %>%     dplyr::filter(type == \"exon\") %>%     ggplot(aes(         xstart = start,         xend = end,         y = transcript_name     )) +     geom_range() +     geom_intron(         data = pknox1_rescaled %>% dplyr::filter(type == \"intron\"),         arrow.min.intron.length = 300     ) +     geom_range(         data = pknox1_rescaled_diffs,         aes(fill = diff_type),         alpha = 0.2     )"},{"path":"/reference/sod1_annotation.html","id":null,"dir":"Reference","previous_headings":"","what":"Example transcript annotation — sod1_annotation","title":"Example transcript annotation — sod1_annotation","text":"Transcript annotation including co-ordinates (hg38) genes, transcripts, exons CDS regions SOD1 PKNOX1, originate version 105 Ensembl reference annotation.","code":""},{"path":"/reference/sod1_annotation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Example transcript annotation — sod1_annotation","text":"","code":"sod1_annotation  pknox1_annotation"},{"path":"/reference/sod1_annotation.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Example transcript annotation — sod1_annotation","text":"tibble::tibble(): seqnames factor() chromosome. start integer() start position. end integer() end position. strand factor() strand. type factor() E.g.gene, transcript, exon CDS. gene_name character() name gene (GBA). transcript_name character() name transcript. transcript_biotype character() biotype transcript. object class tbl_df (inherits tbl, data.frame) 112 rows 8 columns.","code":""},{"path":"/reference/sod1_annotation.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Example transcript annotation — sod1_annotation","text":"generated using ggtranscript/data-raw/sod1_pknox1_annotation.R","code":""},{"path":"/reference/sod1_junctions.html","id":null,"dir":"Reference","previous_headings":"","what":"Example junctions — sod1_junctions","title":"Example junctions — sod1_junctions","text":"Junction co-ordinates counts associated SOD1 gene. Junctions counts originate GTEx liver samples downloaded via Bioconductor package snapcount. unannotated junctions mean count 0.3 retained example.","code":""},{"path":"/reference/sod1_junctions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Example junctions — sod1_junctions","text":"","code":"sod1_junctions"},{"path":"/reference/sod1_junctions.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Example junctions — sod1_junctions","text":"tibble::tibble(): seqnames factor() chromosome. start integer() start position. end integer() end position. strand factor() strand. mean_count factor() Average count across GTEx liver samples.","code":""},{"path":"/reference/sod1_junctions.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Example junctions — sod1_junctions","text":"generated using ggtranscript/data-raw/sod1_junctions.R","code":""},{"path":"/reference/to_diff.html","id":null,"dir":"Reference","previous_headings":"","what":"Obtain the differences between transcript structure — to_diff","title":"Obtain the differences between transcript structure — to_diff","text":"to_diff() obtains difference exons set transcripts reference transcript (ref_exons). can useful visualizing differences transcript structure. to_diff() expects two sets input exons; 1. exons - exons number transcripts compared ref_exons 2. ref_exons - exons single transcript acts reference compare .","code":""},{"path":"/reference/to_diff.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Obtain the differences between transcript structure — to_diff","text":"","code":"to_diff(exons, ref_exons, group_var = NULL)"},{"path":"/reference/to_diff.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Obtain the differences between transcript structure — to_diff","text":"exons data.frame() contains exons can originate multiple transcripts differentiated group_var. ref_exons data.frame() contains exons originate single transcript, exons compared . group_var character() input data originates 1 transcript, group_var must specify column differentiates transcripts (e.g. \"transcript_id\").","code":""},{"path":"/reference/to_diff.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Obtain the differences between transcript structure — to_diff","text":"data.frame() details differences exons ref_exons.","code":""},{"path":"/reference/to_diff.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Obtain the differences between transcript structure — to_diff","text":"","code":"library(magrittr) library(ggplot2)  # to illustrate the package's functionality # ggtranscript includes example transcript annotation sod1_annotation %>% head() #> # A tibble: 6 × 8 #>   seqnames  start    end strand type  gene_name transcript_name transcript_biot… #>   <fct>     <int>  <int> <fct>  <fct> <chr>     <chr>           <chr>            #> 1 21       3.17e7 3.17e7 +      gene  SOD1      NA              NA               #> 2 21       3.17e7 3.17e7 +      tran… SOD1      SOD1-202        protein_coding   #> 3 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-202        protein_coding   #> 4 21       3.17e7 3.17e7 +      CDS   SOD1      SOD1-202        protein_coding   #> 5 21       3.17e7 3.17e7 +      star… SOD1      SOD1-202        protein_coding   #> 6 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-202        protein_coding    # extract exons sod1_exons <- sod1_annotation %>% dplyr::filter(type == \"exon\") sod1_exons %>% head() #> # A tibble: 6 × 8 #>   seqnames  start    end strand type  gene_name transcript_name transcript_biot… #>   <fct>     <int>  <int> <fct>  <fct> <chr>     <chr>           <chr>            #> 1 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-202        protein_coding   #> 2 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-202        protein_coding   #> 3 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-202        protein_coding   #> 4 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-202        protein_coding   #> 5 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-202        protein_coding   #> 6 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-204        processed_trans…  # for this example, let's compare transcripts to the MANE-select transcript sod1_mane <- sod1_exons %>% dplyr::filter(transcript_name == \"SOD1-201\") sod1_not_mane <- sod1_exons %>% dplyr::filter(transcript_name != \"SOD1-201\")  # to_diff() obtains the differences between the exons as ranges sod1_diffs <- to_diff(     exons = sod1_not_mane,     ref_exons = sod1_mane,     group_var = \"transcript_name\" )  sod1_diffs %>% head() #>   seqnames    start      end width strand type  diff_type transcript_name #> 1       21 31659666 31659692    27      + diff not_in_ref        SOD1-202 #> 2       21 31659785 31659841    57      + diff     in_ref        SOD1-202 #> 3       21 31661549 31661734   186      + diff not_in_ref        SOD1-204 #> 4       21 31667342 31667375    34      + diff     in_ref        SOD1-204 #> 5       21 31668471 31668931   461      + diff     in_ref        SOD1-204 #> 6       21 31659693 31659708    16      + diff     in_ref        SOD1-203  # using geom_range(), it can be useful to visually overlay # the differences on top of the transcript annotation sod1_exons %>%     ggplot(aes(         xstart = start,         xend = end,         y = transcript_name     )) +     geom_range() +     geom_intron(         data = to_intron(sod1_exons, \"transcript_name\")     ) +     geom_range(         data = sod1_diffs,         ggplot2::aes(fill = diff_type),         alpha = 0.2     )"},{"path":"/reference/to_intron.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert exon co-ordinates to introns — to_intron","title":"Convert exon co-ordinates to introns — to_intron","text":"Given set exons, to_intron() return corresponding introns. exons contains data originating 1 transcript, group_var must specify column differentiates transcripts (e.g. \"transcript_id\").","code":""},{"path":"/reference/to_intron.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert exon co-ordinates to introns — to_intron","text":"","code":"to_intron(exons, group_var = NULL)"},{"path":"/reference/to_intron.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert exon co-ordinates to introns — to_intron","text":"exons data.frame() contains exons can originate multiple transcripts differentiated group_var. group_var character() input data originates 1 transcript, group_var must specify column differentiates transcripts (e.g. \"transcript_id\").","code":""},{"path":"/reference/to_intron.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Convert exon co-ordinates to introns — to_intron","text":"important note , visualisation purposes, to_intron() defines introns precisely exon boundaries, rather intron start/end (exon end + 1)/(exon start - 1).","code":""},{"path":"/reference/to_intron.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert exon co-ordinates to introns — to_intron","text":"","code":"library(magrittr) library(ggplot2)  # to illustrate the package's functionality # ggtranscript includes example transcript annotation sod1_annotation %>% head() #> # A tibble: 6 × 8 #>   seqnames  start    end strand type  gene_name transcript_name transcript_biot… #>   <fct>     <int>  <int> <fct>  <fct> <chr>     <chr>           <chr>            #> 1 21       3.17e7 3.17e7 +      gene  SOD1      NA              NA               #> 2 21       3.17e7 3.17e7 +      tran… SOD1      SOD1-202        protein_coding   #> 3 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-202        protein_coding   #> 4 21       3.17e7 3.17e7 +      CDS   SOD1      SOD1-202        protein_coding   #> 5 21       3.17e7 3.17e7 +      star… SOD1      SOD1-202        protein_coding   #> 6 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-202        protein_coding    # extract exons sod1_exons <- sod1_annotation %>% dplyr::filter(type == \"exon\") sod1_exons %>% head() #> # A tibble: 6 × 8 #>   seqnames  start    end strand type  gene_name transcript_name transcript_biot… #>   <fct>     <int>  <int> <fct>  <fct> <chr>     <chr>           <chr>            #> 1 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-202        protein_coding   #> 2 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-202        protein_coding   #> 3 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-202        protein_coding   #> 4 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-202        protein_coding   #> 5 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-202        protein_coding   #> 6 21       3.17e7 3.17e7 +      exon  SOD1      SOD1-204        processed_trans…  # to_intron() is a helper function included in ggtranscript # which is useful for converting exon co-ordinates to introns sod1_introns <- sod1_exons %>% to_intron(group_var = \"transcript_name\") sod1_introns %>% head() #> # A tibble: 6 × 8 #>   seqnames strand type  gene_name transcript_name transcript_biot…  start    end #>   <fct>    <fct>  <chr> <chr>     <chr>           <chr>             <int>  <int> #> 1 21       +      intr… SOD1      SOD1-204        processed_trans… 3.17e7 3.17e7 #> 2 21       +      intr… SOD1      SOD1-202        protein_coding   3.17e7 3.17e7 #> 3 21       +      intr… SOD1      SOD1-204        processed_trans… 3.17e7 3.17e7 #> 4 21       +      intr… SOD1      SOD1-201        protein_coding   3.17e7 3.17e7 #> 5 21       +      intr… SOD1      SOD1-203        processed_trans… 3.17e7 3.17e7 #> 6 21       +      intr… SOD1      SOD1-202        protein_coding   3.17e7 3.17e7  # this can be particular useful when combined with # geom_range() and geom_intron() # to visualize the core components of transcript annotation sod1_exons %>%     ggplot(aes(         xstart = start,         xend = end,         y = transcript_name     )) +     geom_range() +     geom_intron(         data = to_intron(sod1_exons, \"transcript_name\")     )"},{"path":"/news/index.html","id":"ggtranscript-0991","dir":"Changelog","previous_headings":"","what":"ggtranscript 0.99.1","title":"ggtranscript 0.99.1","text":"NEW FEATURES Implement base geoms: geom_range, geom_half_range, geom_intron helper functions: to_intron, to_diff shorten_gaps","code":""}]
